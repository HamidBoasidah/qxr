# وثيقة المتطلبات

## المقدمة

إزالة كل ما يتعلق بالحجوزات (booking) من نظام المحادثات وتحويله لنظام دردشة مفتوح بين المستخدمين. النظام الحالي يفرض قيوداً تشمل: ربط المحادثة بحجز معين، تحديد عدد الرسائل خارج وقت الجلسة (رسالتان فقط للعميل)، والتحقق من حالة الحجز قبل إرسال الرسائل. الهدف هو إزالة هذه القيود بالكامل.

## قاموس المصطلحات

- **النظام (System)**: نظام المحادثات في التطبيق
- **المحادثة (Conversation)**: جلسة تواصل بين مستخدمين
- **المشارك (Participant)**: مستخدم مشارك في محادثة
- **الرسالة (Message)**: محتوى نصي أو مرفق يُرسل ضمن محادثة

## المتطلبات

### المتطلب 1: إنشاء محادثات بين المستخدمين

**قصة المستخدم:** كمستخدم، أريد بدء محادثة مع مستخدم آخر مباشرة، حتى أتمكن من التواصل بحرية.

#### معايير القبول

1. WHEN مستخدم يطلب بدء محادثة مع مستخدم آخر THEN THE النظام SHALL ينشئ محادثة جديدة
2. WHEN مستخدم يطلب بدء محادثة مع مستخدم موجودة بينهما محادثة سابقة THEN THE النظام SHALL يُرجع المحادثة الموجودة
3. THE النظام SHALL يُزيل حقل booking_id من جدول المحادثات بالكامل
4. WHEN مستخدم يحاول بدء محادثة مع نفسه THEN THE النظام SHALL يرفض الطلب

### المتطلب 2: إرسال رسائل بدون قيود

**قصة المستخدم:** كمشارك في محادثة، أريد إرسال رسائل بدون حدود عددية، حتى أتمكن من التواصل بحرية.

#### معايير القبول

1. WHEN مشارك يُرسل رسالة THEN THE النظام SHALL يحفظ الرسالة بدون أي تحقق من حدود
2. THE النظام SHALL يُزيل حقل context من جدول الرسائل بالكامل
3. THE النظام SHALL يُزيل كل منطق التحقق من الجلسات (isInSession)
4. THE النظام SHALL يُزيل كل منطق عد الرسائل (countClientOutOfSessionMessages)

### المتطلب 3: التحقق من المشاركة فقط

**قصة المستخدم:** كمشارك في محادثة، أريد إرسال رسائل بشرط واحد فقط وهو أن أكون مشاركاً في المحادثة.

#### معايير القبول

1. WHEN مشارك يُرسل رسالة THEN THE النظام SHALL يتحقق فقط من أن المُرسل مشارك في المحادثة
2. THE النظام SHALL يُزيل كل التحقق من حالة الحجز
3. THE النظام SHALL يُزيل كل علاقات الحجز من الكود
