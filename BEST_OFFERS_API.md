# Best Offers API - ุฃูุถู ุงูุนุฑูุถ

ุชู ุฅุถุงูุฉ API endpoint ุฌุฏูุฏ ูุฅุฑุฌุงุน ุฃูุถู ุงูุนุฑูุถ ุญุณุจ ูููุฉ ุงูุฎุตู.

## ๐ ุงููุญุชููุงุช

1. [ูุธุฑุฉ ุนุงูุฉ](#ูุธุฑุฉ-ุนุงูุฉ)
2. [ูุนุงููุฑ ุงูุชุฑุชูุจ](#ูุนุงููุฑ-ุงูุชุฑุชูุจ)
3. [ููููุฉ ุงูุงุณุชุฎุฏุงู](#ููููุฉ-ุงูุงุณุชุฎุฏุงู)
4. [ููููุฉ ุงูุงุฎุชุจุงุฑ](#ููููุฉ-ุงูุงุฎุชุจุงุฑ)
5. [ุฃูุซูุฉ](#ุฃูุซูุฉ)

---

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

### Endpoint
```
GET /api/offers/public/best
```

### ุงููุตู
ูุฑุฌุน ุฃูุถู ุงูุนุฑูุถ ุงููุดุทุฉ ูุฑุชุจุฉ ุญุณุจ **ุฃุนูู ูููุฉ ุฎุตู**ุ ูุน ุฏุนู ุงูุนุฑูุถ ุงูุนุงูุฉ ูุงูุฎุงุตุฉ ุงููุณุชูุฏูุฉ ูููุณุชุฎุฏู ุงููุณุฌู.

### ุงููุตุงุฏูุฉ
```
Authorization: Bearer {token}
Accept: application/json
```

---

## ๐ ูุนุงููุฑ ุงูุชุฑุชูุจ

### ููููุฉ ุญุณุงุจ ูููุฉ ุงูุฎุตู

ุงูู API ูุญุณุจ ูููุฉ ุงูุฎุตู ููู ููุชุฌ ูู ุงูุนุฑุถ ุจูุงุกู ุนูู ููุน ุงูุฎุตู:

#### 1. ุฎุตู ูุณุจุฉ ูุฆููุฉ (discount_percent)
```
ูููุฉ ุงูุฎุตู = ุณุนุฑ ุงูููุชุฌ ร ุงููุณุจุฉ ุงููุฆููุฉ รท 100
```
**ูุซุงู:** ููุชุฌ ุจุณุนุฑ 1000 ุฑูุงู ูุน ุฎุตู 20% = 200 ุฑูุงู

#### 2. ุฎุตู ุซุงุจุช (discount_fixed)
```
ูููุฉ ุงูุฎุตู = ุงููุจูุบ ุงูุซุงุจุช
```
**ูุซุงู:** ุฎุตู ุซุงุจุช 150 ุฑูุงู = 150 ุฑูุงู

#### 3. ููุชุฌ ููุงูุฃุฉ (bonus)
```
ูููุฉ ุงูุฎุตู = ุณุนุฑ ููุชุฌ ุงูููุงูุฃุฉ ร ุนุฏุฏ ุงูุจููุต
```
**ูุซุงู:** ููุชุฌ ููุงูุฃุฉ ุจุณุนุฑ 300 ุฑูุงู ร 2 ูุทุนุฉ = 600 ุฑูุงู

### ุงูุชุฑุชูุจ ุงูููุงุฆู
- ูุชู ุฃุฎุฐ **ุฃุนูู ูููุฉ ุฎุตู** ูู ุฌููุน ุงูููุชุฌุงุช ูู ูู ุนุฑุถ
- ูุชู ุชุฑุชูุจ ุงูุนุฑูุถ ูู ุงูุฃุนูู ูููุฉู ููุฃูู

---

## ๐ง ููููุฉ ุงูุงุณุชุฎุฏุงู

### Query Parameters

| Parameter | Type | Required | Default | Description |
|-----------|------|----------|---------|-------------|
| `per_page` | integer | No | 10 | ุนุฏุฏ ุงูุนุฑูุถ ูู ุงูุตูุญุฉ |
| `page` | integer | No | 1 | ุฑูู ุงูุตูุญุฉ |

### ุงูููุงุชุฑ ุงููุทุจูุฉ ุชููุงุฆูุงู

1. **ุงูุนุฑูุถ ุงููุดุทุฉ ููุท**: `status = 'active'`
2. **ุงูุนุฑูุถ ุงูุณุงุฑูุฉ**: 
   - ุฅูุง ุจุฏูู ุชุงุฑูุฎ ุจุฏุงูุฉ ุฃู ุจุฏุฃุช ูุนูุงู
   - ุฅูุง ุจุฏูู ุชุงุฑูุฎ ููุงูุฉ ุฃู ูู ุชูุชูู ุจุนุฏ
3. **ุงููุทุงู (Scope)**:
   - ุงูุนุฑูุถ ุงูุนุงูุฉ (`scope = 'public'`)
   - ุฃู ุงูุนุฑูุถ ุงูุฎุงุตุฉ ุงููุณุชูุฏูุฉ ูููุณุชุฎุฏู (`scope = 'private'` + ูุณุชูุฏู)

---

## ๐ ูุซุงู ุนูู ุงูุทูุจ

### cURL
```bash
curl -X GET "http://localhost:8000/api/offers/public/best?per_page=10" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Accept: application/json"
```

### JavaScript (Fetch)
```javascript
fetch('http://localhost:8000/api/offers/public/best?per_page=10', {
  headers: {
    'Authorization': `Bearer ${token}`,
    'Accept': 'application/json'
  }
})
.then(response => response.json())
.then(data => console.log(data));
```

---

## ๐ค ูุซุงู ุนูู ุงูุงุณุชุฌุงุจุฉ

```json
{
  "success": true,
  "message": "ุชู ุฌูุจ ุฃูุถู ุงูุนุฑูุถ ุจูุฌุงุญ",
  "status_code": 200,
  "data": {
    "current_page": 1,
    "data": [
      {
        "offer_id": 12,
        "title": "ุนุฑุถ ุฎุตู 50% ุนูู ุงูุฅููุชุฑูููุงุช",
        "description": "ุฎุตู ูุจูุฑ ุนูู ุฌููุน ุงูููุชุฌุงุช ุงูุฅููุชุฑูููุฉ",
        "scope": "public",
        "status": "active",
        "start_at": "2026-02-01 00:00:00",
        "end_at": "2026-02-28 23:59:59",
        "created_at": "2026-02-01 10:30:00",
        "updated_at": "2026-02-15 14:20:00",
        "company": {
          "id": 5,
          "name": "ุฃุญูุฏ ูุญูุฏ",
          "business_name": "ุดุฑูุฉ ุงูุชูููุฉ ุงูุญุฏูุซุฉ"
        },
        "max_discount_value": 500.00
      },
      {
        "offer_id": 8,
        "title": "ุงุดุชุฑู 2 ูุงุญุตู ุนูู 1 ูุฌุงูุงู",
        "description": "ุนุฑุถ ุฎุงุต ุนูู ููุชุฌุงุช ุงูุนูุงูุฉ",
        "scope": "public",
        "status": "active",
        "start_at": "2026-02-10 00:00:00",
        "end_at": "2026-02-25 23:59:59",
        "max_discount_value": 350.00
      },
      {
        "offer_id": 15,
        "title": "ุฎุตู 200 ุฑูุงู ุนูู ุงูุทูุจุงุช ุงููุจูุฑุฉ",
        "scope": "private",
        "status": "active",
        "start_at": null,
        "end_at": null,
        "max_discount_value": 200.00
      }
    ],
    "per_page": 10,
    "total": 25,
    "last_page": 3
  }
}
```

---

## ๐งช ููููุฉ ุงูุงุฎุชุจุงุฑ

### 1. ุงุณุชูุฑุงุฏ ููู Postman

1. ุงูุชุญ Postman
2. ุงุฐูุจ ุฅูู **File** > **Import**
3. ุงุฎุชุฑ ุงูููู: `postman/Best_Offers_API.postman_collection.json`
4. ุณูุชู ุงุณุชูุฑุงุฏ Collection ุจูุง ุทูุจ ูุงุญุฏ

### 2. ุฅุนุฏุงุฏ ุงููุชุบูุฑุงุช

ูุจู ุงูุงุฎุชุจุงุฑุ ูู ุจุชุนููู ุงููุชุบูุฑุงุช ูู Postman:

| Variable | Value | Description |
|----------|-------|-------------|
| `base_url` | `http://localhost:8000/api` | ุฑุงุจุท ุงูู API |
| `token` | `YOUR_AUTH_TOKEN` | ุงูู Bearer token ูููุตุงุฏูุฉ |

**ููุญุตูู ุนูู ุงูู token:**
1. ุงุณุชุฎุฏู endpoint ุชุณุฌูู ุงูุฏุฎูู: `POST /api/login`
2. ุงูุณุฎ ุงูู `token` ูู ุงูุงุณุชุฌุงุจุฉ
3. ุถุนู ูู ูุชุบูุฑ `token` ูู Postman

### 3. ุชุดุบูู ุงูุงุฎุชุจุงุฑ

1. ุงุฎุชุฑ ุทูุจ "Best Offers - ุฃูุถู ุงูุนุฑูุถ" ูู Collection
2. ุงุถุบุท ุนูู **Send**
3. ุณุชุธูุฑ ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑุงุช ุงูุชููุงุฆูุฉ ูู ุชุจููุจ **Test Results**

### 4. ุงูุงุฎุชุจุงุฑุงุช ุงูุชููุงุฆูุฉ

ูุชุถูู ุงูุทูุจ ุงุฎุชุจุงุฑุงุช ุชููุงุฆูุฉ ุชุชุญูู ูู:
- โ ูุฌุงุญ ุงูุทูุจ (Status 200)
- โ ูุฌูุฏ success flag
- โ ุตุญุฉ ุจููุฉ ุงูุจูุงูุงุช
- โ ุตุญุฉ ุจููุฉ Pagination
- โ ูุฌูุฏ ุงูุญููู ุงููุทููุจุฉ ูู ุงูุนุฑุถ
- โ ุฃู ุฌููุน ุงูุนุฑูุถ ูุดุทุฉ (active)
- โ ูุฌูุฏ ูููุฉ ุงูุฎุตู (max_discount_value)
- โ ุงูุชุฑุชูุจ ุงูุตุญูุญ (ูู ุงูุฃุนูู ููุฃูู)

---

## ๐ฏ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู

### 1. ูุณู "ุฃูุถู ุงูุนุฑูุถ" ูู ุงูุชุทุจูู
ุงุนุฑุถ ุฃูุถู 5 ุนุฑูุถ ูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ:
```bash
GET /api/offers/public/best?per_page=5
```

### 2. ุตูุญุฉ ูุฎุตุตุฉ ูุฃูุถู ุงูุนุฑูุถ
ุงุนุฑุถ ุฌููุน ุงูุนุฑูุถ ูุน pagination:
```bash
GET /api/offers/public/best?per_page=20&page=1
```

### 3. ููุงุฑูุฉ ุงูุฎุตููุงุช
ุงุณุชุฎุฏู ุญูู `max_discount_value` ูุนุฑุถ "ูููุฑ ุญุชู X ุฑูุงู":
```javascript
offer.max_discount_value // 500.00
// ุนุฑุถ: "ูููุฑ ุญุชู 500 ุฑูุงู!"
```

---

## ๐ ุงููุฑู ุจูู ุงูู Endpoints

| Endpoint | ุงููุตู | ุงูุชุฑุชูุจ |
|----------|-------|---------|
| `/offers/public` | ุฌููุน ุงูุนุฑูุถ ุงูุนุงูุฉ | ุงูุฃุญุฏุซ (`created_at DESC`) |
| `/offers/public/best` | ุฃูุถู ุงูุนุฑูุถ | ุงูุฃุนูู ุฎุตูุงู (`max_discount_value DESC`) |
| `/offers/public/details` | ุงูุนุฑูุถ ูุน ุชูุงุตูู ุงูููุชุฌุงุช | ุงูุฃุญุฏุซ |

---

## ๐ ุจููุฉ ุงูุจูุงูุงุช

### ุญูู `max_discount_value`
- **ุงูููุน**: `number` (float)
- **ุงููุญุฏุฉ**: ุฑูุงู
- **ุงููุตู**: ุฃุนูู ูููุฉ ุฎุตู ูู ุฌููุน ููุชุฌุงุช ุงูุนุฑุถ
- **ุงูุญุณุงุจ**: ุชููุงุฆู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- **ูุซุงู**: `500.00` ูุนูู ุฃุนูู ุฎุตู ูู ูุฐุง ุงูุนุฑุถ ูู 500 ุฑูุงู

### ุจูุงูุงุช ุงูุนุฑุถ
ูุชุถูู ูู ุนุฑุถ:
- `offer_id`: ูุนุฑู ุงูุนุฑุถ
- `title`: ุนููุงู ุงูุนุฑุถ
- `description`: ูุตู ุงูุนุฑุถ
- `scope`: ูุทุงู ุงูุนุฑุถ (`public` ุฃู `private`)
- `status`: ุญุงูุฉ ุงูุนุฑุถ (ุฏุงุฆูุงู `active` ูู ูุฐุง ุงูู endpoint)
- `start_at`: ุชุงุฑูุฎ ุงูุจุฏุงูุฉ (nullable)
- `end_at`: ุชุงุฑูุฎ ุงูููุงูุฉ (nullable)
- `company`: ุจูุงูุงุช ุงูุดุฑูุฉ ุตุงุญุจุฉ ุงูุนุฑุถ
- `max_discount_value`: **ุฃุนูู ูููุฉ ุฎุตู** ๐ฅ

---

## โ๏ธ ุงูุชูุงุตูู ุงูุชูููุฉ

### SQL Query
ูุณุชุฎุฏู ุงูู endpoint query ูุนูุฏ ูุน:
- `LEFT JOIN` ูุน ุฌุฏูู `offer_items`
- `LEFT JOIN` ูุน ุฌุฏูู `products` (ุงูููุชุฌุงุช ุงูุฃุณุงุณูุฉ)
- `LEFT JOIN` ูุน ุฌุฏูู `products` (ููุชุฌุงุช ุงูููุงูุฃุฉ)
- `CASE` statement ูุญุณุงุจ ูููุฉ ุงูุฎุตู
- `MAX()` aggregate function ูุฃุฎุฐ ุฃุนูู ูููุฉ
- `GROUP BY` ุญุณุจ `offers.id`
- `ORDER BY max_discount_value DESC`

### ุงูุฃุฏุงุก
- โ Indexed joins ููุฃุฏุงุก ุงูุนุงูู
- โ Pagination ูุชูููู ุญุฌู ุงูุจูุงูุงุช
- โ Eager loading ููุนูุงูุงุช
- โ ุญุณุงุจ ุงููููุฉ ูุฑุฉ ูุงุญุฏุฉ ูู SQL

---

## ๐ ููุงุญุธุงุช ุฅุถุงููุฉ

### ุงูุนุฑูุถ ุงูุฎุงุตุฉ ุงููุณุชูุฏูุฉ
ุงูู API ูุฏุนู ุนุฑุถ ุงูุนุฑูุถ ุงูุฎุงุตุฉ ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุณุชูุฏูุงู ุจูุง ุนุจุฑ:
- **ูุณุชูุฏู ูุจุงุดุฑ**: `target_type = 'customer'` ู `target_id = user_id`
- **ูุณุชูุฏู ุนุจุฑ ุงููุฆุฉ**: `target_type = 'customer_category'` ู `target_id = user.category_id`

### ุงูุชุงุฑูุฎ ูุงูููุช
- ุงูุนุฑูุถ ุจุฏูู `start_at` ุชูุนุชุจุฑ ุจุฏุฃุช ููุฑุงู
- ุงูุนุฑูุถ ุจุฏูู `end_at` ุชูุนุชุจุฑ ููุชูุญุฉ ุฅูู ุฃุฌู ุบูุฑ ูุณูู
- ุงูุชูุงุฑูุฎ ูุญุณูุจุฉ ุญุณุจ ุชูููุช ุงูุณูุฑูุฑ

---

## โ ุฌุงูุฒ ููุงุณุชุฎุฏุงู!

ุงูุขู ููููู:
1. โ ุงุณุชุฎุฏุงู ุงูู API ูู ุงูุชุทุจูู
2. โ ุงุฎุชุจุงุฑูุง ุนุจุฑ Postman
3. โ ุนุฑุถ ุฃูุถู ุงูุนุฑูุถ ูููุณุชุฎุฏููู
4. โ ุงุณุชุฎุฏุงู ูููุฉ ุงูุฎุตู ูู ุงููุงุฌูุฉ

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก:** 24 ูุจุฑุงูุฑ 2026  
**ุงูุฅุตุฏุงุฑ:** 1.0.0  
**Endpoint:** `GET /api/offers/public/best`
